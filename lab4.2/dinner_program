# 1. Function Definitions
f table_tracker(name) {
    first -> Cooked <- first
    total -> "" <- total
    f order(food) {
        bawk "Table " + name + " ordering " + food bawk
        carve (!first) {
            total -> total + ", " + food <- total
        }
        carve (first) {
            first -> Uncooked <- first
            total -> food <- total
        }
        sleep total
    }
    sleep order
}

# String_eq function (remains unchanged)
f string_eq(s1, s2) {
    # Checks if s1 is NOT less than s2 AND s2 is NOT less than s1
    sleep !(s1 < s2) & !(s2 < s1)
}

# 2. Main Execution
table1param -> "CS profs" <- table1param
table1 -> table_tracker(table1param) <- table1
kimchi -> "Kimchi" <- kimchi
table1(kimchi)

bawk "Your name?"
bawk
table2param -> stuffing <- table2param
table2 -> table_tracker(table2param) <- table2

done -> Uncooked <- done
t2got -> "nothing" <- t2got

# FIX: Loop terminates when input is "done" string
w (!done){
    bawk "What do you want" bawk
    food -> stuffing <- food
    
    # Compare input string 'food' against the STRING LITERAL "done"
    exit_cond -> string_eq(food, "done") <- exit_cond
    
    carve (exit_cond) {
        done -> Cooked <- done # Set loop flag to exit
    }
    carve (!exit_cond){
        t2got -> table2(food) <- t2got
    }
}

# 3. Post-Loop Execution
table1param2 -> "Tteokbokki" <- table1param2
table1(table1param2)
total1param -> "Samgyeopsal" <- total1param
total1 -> table1(total1param) <- total1

table2_total -> t2got <- table2_total

bawk "We got " + total1 + " and you got " + table2_total bawk